<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Ailamazyan_Code</title>
</head>


<body>
<div class="head">
<h1>Theory Ailamazyan_Code</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command">theory</span></span> Ailamazyan_Code
  <span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../../HOL/HOL-Library/Code_Target_Nat.html">HOL-Library.Code_Target_Nat</a>"</span> <span class="quoted">"<a href="../../AFP/Containers/Containers.html">Containers.Containers</a>"</span> <a href="Ailamazyan.html">Ailamazyan</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">(* Convert database to fo_intp *)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">insert_db</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span> set<span class="main">)</span> mapping <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'b</span> set<span class="main">)</span> mapping"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">insert_db</span> <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="free"><span class="bound"><span class="entity">m</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">case</span> Mapping.lookup <span class="free"><span class="bound"><span class="entity">m</span></span></span> <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="keyword1">of</span> None <span class="main">⇒</span>
    Mapping.update <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">(</span><span class="main">{</span><span class="free"><span class="bound"><span class="entity">v</span></span></span><span class="main">}</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">m</span></span></span>
  <span class="main">|</span> Some <span class="bound">vs</span> <span class="main">⇒</span> Mapping.update <span class="free"><span class="bound"><span class="entity">k</span></span></span> <span class="main">(</span><span class="main">(</span><span class="main">{</span><span class="free"><span class="bound"><span class="entity">v</span></span></span><span class="main">}</span> <span class="main">∪</span> <span class="bound">vs</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">convert_db_rec</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> <span class="main">×</span> <span class="tfree">'c</span> list<span class="main">)</span> list <span class="main">⇒</span> <span class="main">(</span><span class="main">(</span><span class="tfree">'a</span> <span class="main">×</span> nat<span class="main">)</span><span class="main">,</span> <span class="tfree">'c</span> list set<span class="main">)</span> mapping <span class="main">⇒</span>
  <span class="main">(</span><span class="main">(</span><span class="tfree">'a</span> <span class="main">×</span> nat<span class="main">)</span><span class="main">,</span> <span class="tfree">'c</span> list set<span class="main">)</span> mapping"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">convert_db_rec</span> <span class="main">[]</span> <span class="free"><span class="bound"><span class="entity">m</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">m</span></span></span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">convert_db_rec</span> <span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span> <span class="main">#</span> <span class="free"><span class="bound"><span class="entity">ktss</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">m</span></span></span> <span class="main">=</span> <span class="free">convert_db_rec</span> <span class="free"><span class="bound"><span class="entity">ktss</span></span></span> <span class="main">(</span>insert_db <span class="main">(</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">,</span> length <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span> <span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> convert_db_rec_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"Mapping.lookup <span class="free">m</span> <span class="main">(</span><span class="free">r</span><span class="main">,</span> <span class="free">n</span><span class="main">)</span> <span class="main">=</span> Some <span class="free">tss</span> <span class="main">⟹</span>
  <span class="main">∃</span><span class="bound">tss'</span><span class="main">.</span> Mapping.lookup <span class="main">(</span>convert_db_rec <span class="free">ktss</span> <span class="free">m</span><span class="main">)</span> <span class="main">(</span><span class="free">r</span><span class="main">,</span> <span class="free">n</span><span class="main">)</span> <span class="main">=</span> Some <span class="bound">tss'</span> <span class="main">∧</span> <span class="free">tss</span> <span class="main">⊆</span> <span class="bound">tss'</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">ktss</span></span> <span class="quoted"><span class="free">m</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">tss</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> convert_db_rec.induct<span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> insert_db_def fun_upd_def Mapping.lookup_update' <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> option.splits if_splits<span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> option.discI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">smt</span> option.inject order_trans subset_insertI<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> convert_db_rec_sound<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">r</span><span class="main">,</span> <span class="free">ts</span><span class="main">)</span> <span class="main">∈</span> set <span class="free">ktss</span> <span class="main">⟹</span>
  <span class="main">∃</span><span class="bound">tss</span><span class="main">.</span> Mapping.lookup <span class="main">(</span>convert_db_rec <span class="free">ktss</span> <span class="free">m</span><span class="main">)</span> <span class="main">(</span><span class="free">r</span><span class="main">,</span> length <span class="free">ts</span><span class="main">)</span> <span class="main">=</span> Some <span class="bound">tss</span> <span class="main">∧</span> <span class="free">ts</span> <span class="main">∈</span> <span class="bound">tss</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">ktss</span></span> <span class="quoted"><span class="free">m</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> convert_db_rec.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>2 <span class="skolem">r</span> <span class="skolem">ts</span> <span class="skolem">ktss</span> <span class="skolem">m</span><span class="main">)</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">tss</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"Mapping.lookup <span class="main">(</span>convert_db_rec <span class="skolem">ktss</span> <span class="main">(</span>insert_db <span class="main">(</span><span class="skolem">r</span><span class="main">,</span> length <span class="skolem">ts</span><span class="main">)</span> <span class="skolem">ts</span> <span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="skolem">r</span><span class="main">,</span> length <span class="skolem">ts</span><span class="main">)</span> <span class="main">=</span> Some <span class="skolem">tss</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="skolem">ts</span> <span class="main">∈</span> <span class="skolem">tss</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> convert_db_rec_mono<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"insert_db <span class="main">(</span><span class="skolem">r</span><span class="main">,</span> length <span class="skolem">ts</span><span class="main">)</span> <span class="skolem">ts</span> <span class="skolem">m</span>"</span></span> <span class="quoted"><span class="skolem">r</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">ts</span>"</span></span> <span class="main">_</span> <span class="quoted"><span class="skolem">ktss</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">atomize_elim</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> insert_db_def Mapping.lookup_update' <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> option.splits<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> convert_db_rec_complete<span class="main">:</span> <span class="quoted"><span class="quoted">"Mapping.lookup <span class="main">(</span>convert_db_rec <span class="free">ktss</span> <span class="free">m</span><span class="main">)</span> <span class="main">(</span><span class="free">r</span><span class="main">,</span> <span class="free">n</span><span class="main">)</span> <span class="main">=</span> Some <span class="free">tss'</span> <span class="main">⟹</span>
  <span class="free">ts</span> <span class="main">∈</span> <span class="free">tss'</span> <span class="main">⟹</span>
  <span class="main">(</span>length <span class="free">ts</span> <span class="main">=</span> <span class="free">n</span> <span class="main">∧</span> <span class="main">(</span><span class="free">r</span><span class="main">,</span> <span class="free">ts</span><span class="main">)</span> <span class="main">∈</span> set <span class="free">ktss</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">tss</span><span class="main">.</span> Mapping.lookup <span class="free">m</span> <span class="main">(</span><span class="free">r</span><span class="main">,</span> <span class="free">n</span><span class="main">)</span> <span class="main">=</span> Some <span class="bound">tss</span> <span class="main">∧</span> <span class="free">ts</span> <span class="main">∈</span> <span class="bound">tss</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">ktss</span></span> <span class="quoted"><span class="free">m</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> convert_db_rec.induct<span class="main">)</span>
     <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> insert_db_def Mapping.lookup_update' <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> option.splits if_splits<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">convert_db</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span> <span class="main">×</span> <span class="tfree">'c</span> list<span class="main">)</span> list <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'c</span> table<span class="main">,</span> <span class="tfree">'a</span><span class="main">)</span> fo_intp"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">convert_db</span> <span class="free"><span class="bound"><span class="entity">ktss</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">let</span> <span class="bound">m</span> <span class="main">=</span> convert_db_rec <span class="free"><span class="bound"><span class="entity">ktss</span></span></span> Mapping.empty <span class="keyword1">in</span>
    <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">case</span> Mapping.lookup <span class="bound">m</span> <span class="bound">x</span> <span class="keyword1">of</span> None <span class="main">⇒</span> <span class="main">{}</span> <span class="main">|</span> Some <span class="bound">v</span> <span class="main">⇒</span> <span class="bound">v</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> convert_db_correct<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">ts</span> <span class="main">∈</span> convert_db <span class="free">ktss</span> <span class="main">(</span><span class="free">r</span><span class="main">,</span> <span class="free">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">n</span> <span class="main">=</span> length <span class="free">ts</span><span class="main">)</span> <span class="main">∧</span>
  <span class="main">(</span><span class="main">(</span><span class="free">r</span><span class="main">,</span> <span class="free">ts</span><span class="main">)</span> <span class="main">∈</span> set <span class="free">ktss</span> <span class="main">⟷</span> <span class="free">ts</span> <span class="main">∈</span> convert_db <span class="free">ktss</span> <span class="main">(</span><span class="free">r</span><span class="main">,</span> length <span class="free">ts</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> convert_db_def <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> convert_db_rec_sound<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted">Mapping.empty</span><span class="main"><span class="main">]</span></span>
      <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> option.splits<span class="main">)</span>
     <span class="main">(</span><span class="operator">metis</span> Mapping.lookup_empty convert_db_rec_complete option.distinct<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="comment1">(* Code setup *)</span>

<span class="keyword1"><span class="command">lemma</span></span> Inl_vimage_set_code<span class="main">[</span><span class="operator">code_unfold</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"Inl <span class="main">-`</span> set <span class="free">as</span> <span class="main">=</span> set <span class="main">(</span>List.map_filter <span class="main">(</span>case_sum Some Map.empty<span class="main">)</span> <span class="free">as</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">as</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> List.map_filter_simps <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> option.splits sum.splits<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Inr_vimage_set_code<span class="main">[</span><span class="operator">code_unfold</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"Inr <span class="main">-`</span> set <span class="free">as</span> <span class="main">=</span> set <span class="main">(</span>List.map_filter <span class="main">(</span>case_sum Map.empty Some<span class="main">)</span> <span class="free">as</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">as</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> List.map_filter_simps <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> option.splits sum.splits<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> Inl_vimage_code<span class="main">:</span> <span class="quoted"><span class="quoted">"Inl <span class="main">-`</span> <span class="free">as</span> <span class="main">=</span> projl <span class="main">`</span> <span class="main">{</span><span class="bound"><span class="bound">x</span></span> <span class="main">∈</span> <span class="free">as</span><span class="main">.</span> isl <span class="bound">x</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> vimage_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> ad_pred_code<span class="main">[</span><span class="operator">code</span><span class="main">]</span> <span class="main">=</span> ad_terms.simps<span class="main">[</span><span class="operator">unfolded</span> Inl_vimage_code<span class="main">]</span>
<span class="keyword1"><span class="command">lemmas</span></span> fo_wf_code<span class="main">[</span><span class="operator">code</span><span class="main">]</span> <span class="main">=</span> fo_wf.simps<span class="main">[</span><span class="operator">unfolded</span> Inl_vimage_code<span class="main">]</span>

<span class="comment1">(* Monomorphise *)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">empty_J</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>nat<span class="main">,</span> nat<span class="main">)</span> fo_t<span class="main">,</span> String.literal<span class="main">)</span> fo_intp"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">empty_J</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="main">(</span><span class="main"><span class="bound">_</span></span><span class="main">,</span> <span class="bound">n</span><span class="main">)</span><span class="main">.</span> eval_pred <span class="main">(</span>map Var <span class="main">[</span><span class="main">0</span><span class="main">..&lt;</span><span class="bound">n</span><span class="main">]</span><span class="main">)</span> <span class="main">{}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">eval_fin_nat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat<span class="main">,</span> String.literal<span class="main">)</span> fo_fmla <span class="main">⇒</span> <span class="main">(</span>nat table<span class="main">,</span> String.literal<span class="main">)</span> fo_intp <span class="main">⇒</span> nat eval_res"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">eval_fin_nat</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="main">=</span> eval <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="free"><span class="bound"><span class="entity">I</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">sat_fin_nat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat<span class="main">,</span> String.literal<span class="main">)</span> fo_fmla <span class="main">⇒</span> <span class="main">(</span>nat table<span class="main">,</span> String.literal<span class="main">)</span> fo_intp <span class="main">⇒</span> nat val <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">sat_fin_nat</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="main">=</span> sat <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="free"><span class="bound"><span class="entity">I</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">convert_nat_db</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>String.literal <span class="main">×</span> nat list<span class="main">)</span> list <span class="main">⇒</span>
  <span class="main">(</span>nat table<span class="main">,</span> String.literal<span class="main">)</span> fo_intp"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">convert_nat_db</span> <span class="main">=</span> convert_db"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rbt_nat_fold</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">⇒</span> nat set_rbt <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">rbt_nat_fold</span> <span class="main">=</span> RBT_Set2.fold"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rbt_nat_list_fold</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">⇒</span> <span class="main">(</span>nat list<span class="main">)</span> set_rbt <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">rbt_nat_list_fold</span> <span class="main">=</span> RBT_Set2.fold"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rbt_sum_list_fold</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">⇒</span> <span class="main">(</span><span class="main">(</span>nat <span class="main">+</span> nat<span class="main">)</span> list<span class="main">)</span> set_rbt <span class="main">⇒</span> <span class="main">_</span> <span class="main">⇒</span> <span class="main">_</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">rbt_sum_list_fold</span> <span class="main">=</span> RBT_Set2.fold"</span></span>

<span class="keyword1"><span class="command">export_code</span></span> <span class="quoted"><span class="quoted">eval_fin_nat</span></span> <span class="quoted"><span class="quoted">sat_fin_nat</span></span> <span class="quoted"><span class="quoted">fv_fo_fmla_list</span></span> <span class="quoted"><span class="quoted">convert_nat_db</span></span> <span class="quoted"><span class="quoted">rbt_nat_fold</span></span> <span class="quoted"><span class="quoted">rbt_nat_list_fold</span></span>
  <span class="quoted"><span class="quoted">rbt_sum_list_fold</span></span> <span class="quoted"><span class="quoted">Const</span></span> <span class="quoted"><span class="quoted">Conj</span></span> <span class="quoted"><span class="quoted">Inl</span></span> <span class="quoted"><span class="quoted">Fin</span></span> <span class="quoted"><span class="quoted">nat_of_integer</span></span> <span class="quoted"><span class="quoted">integer_of_nat</span></span> <span class="quoted"><span class="quoted">RBT_set</span></span>
  <span class="keyword2"><span class="keyword">in</span></span> OCaml <span class="keyword2"><span class="keyword">module_name</span></span> Eval_FO <span class="keyword2"><span class="keyword">file_prefix</span></span> verified

<span class="comment1">(* Examples *)</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">φ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat<span class="main">,</span> String.literal<span class="main">)</span> fo_fmla"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">φ</span> <span class="main">≡</span> Exists <span class="main">0</span> <span class="main">(</span>Conj <span class="main">(</span>FO.Eqa <span class="main">(</span>Var <span class="main">0</span><span class="main">)</span> <span class="main">(</span>Const <span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>FO.Eqa <span class="main">(</span>Var <span class="main">0</span><span class="main">)</span> <span class="main">(</span>Var <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">value</span></span> <span class="quoted"><span class="quoted">"eval_fin_nat φ <span class="main">(</span>convert_nat_db <span class="main">[]</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">value</span></span> <span class="quoted"><span class="quoted">"sat_fin_nat φ <span class="main">(</span>convert_nat_db <span class="main">[]</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="main"><span class="bound">_</span></span><span class="main">.</span> <span class="main">0</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">value</span></span> <span class="quoted"><span class="quoted">"sat_fin_nat φ <span class="main">(</span>convert_nat_db <span class="main">[]</span><span class="main">)</span> <span class="main">(</span><span class="main">λ</span><span class="main"><span class="bound">_</span></span><span class="main">.</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ψ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat<span class="main">,</span> String.literal<span class="main">)</span> fo_fmla"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ψ</span> <span class="main">≡</span> Forall <span class="numeral">2</span> <span class="main">(</span>Disj <span class="main">(</span>FO.Eqa <span class="main">(</span>Var <span class="numeral">2</span><span class="main">)</span> <span class="main">(</span>Const <span class="numeral">42</span><span class="main">)</span><span class="main">)</span>
       <span class="main">(</span>Exists <span class="main">1</span> <span class="main">(</span>Conj <span class="main">(</span>FO.Pred <span class="main">(</span>String.implode <span class="inner_quoted">''P''</span><span class="main">)</span> <span class="main">[</span>Var <span class="main">0</span><span class="main">,</span> Var <span class="main">1</span><span class="main">]</span><span class="main">)</span>
                 <span class="main">(</span>Neg <span class="main">(</span>FO.Pred <span class="main">(</span>String.implode <span class="inner_quoted">''Q''</span><span class="main">)</span> <span class="main">[</span>Var <span class="main">1</span><span class="main">,</span> Var <span class="numeral">2</span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">value</span></span> <span class="quoted"><span class="quoted">"eval_fin_nat ψ <span class="main">(</span>convert_nat_db
   <span class="main">[</span><span class="main">(</span>String.implode <span class="inner_quoted">''P''</span><span class="main">,</span> <span class="main">[</span><span class="main">1</span><span class="main">,</span> <span class="numeral">20</span><span class="main">]</span><span class="main">)</span><span class="main">,</span>
    <span class="main">(</span>String.implode <span class="inner_quoted">''P''</span><span class="main">,</span> <span class="main">[</span><span class="numeral">9</span><span class="main">,</span> <span class="numeral">20</span><span class="main">]</span><span class="main">)</span><span class="main">,</span>
    <span class="main">(</span>String.implode <span class="inner_quoted">''P''</span><span class="main">,</span> <span class="main">[</span><span class="numeral">2</span><span class="main">,</span> <span class="numeral">30</span><span class="main">]</span><span class="main">)</span><span class="main">,</span>
    <span class="main">(</span>String.implode <span class="inner_quoted">''P''</span><span class="main">,</span> <span class="main">[</span><span class="numeral">3</span><span class="main">,</span> <span class="numeral">31</span><span class="main">]</span><span class="main">)</span><span class="main">,</span>
    <span class="main">(</span>String.implode <span class="inner_quoted">''P''</span><span class="main">,</span> <span class="main">[</span><span class="numeral">4</span><span class="main">,</span> <span class="numeral">32</span><span class="main">]</span><span class="main">)</span><span class="main">,</span>
    <span class="main">(</span>String.implode <span class="inner_quoted">''P''</span><span class="main">,</span> <span class="main">[</span><span class="numeral">5</span><span class="main">,</span> <span class="numeral">30</span><span class="main">]</span><span class="main">)</span><span class="main">,</span>
    <span class="main">(</span>String.implode <span class="inner_quoted">''P''</span><span class="main">,</span> <span class="main">[</span><span class="numeral">6</span><span class="main">,</span> <span class="numeral">30</span><span class="main">]</span><span class="main">)</span><span class="main">,</span>
    <span class="main">(</span>String.implode <span class="inner_quoted">''P''</span><span class="main">,</span> <span class="main">[</span><span class="numeral">7</span><span class="main">,</span> <span class="numeral">30</span><span class="main">]</span><span class="main">)</span><span class="main">,</span>
    <span class="main">(</span>String.implode <span class="inner_quoted">''Q''</span><span class="main">,</span> <span class="main">[</span><span class="numeral">20</span><span class="main">,</span> <span class="numeral">42</span><span class="main">]</span><span class="main">)</span><span class="main">,</span>
    <span class="main">(</span>String.implode <span class="inner_quoted">''Q''</span><span class="main">,</span> <span class="main">[</span><span class="numeral">30</span><span class="main">,</span> <span class="numeral">43</span><span class="main">]</span><span class="main">)</span><span class="main">]</span><span class="main">)</span>"</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>